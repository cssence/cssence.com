<!DOCTYPE html>
<html class="c-code" lang="en">
<head>
<title>:focus-visible and JavaScript</title>
<meta name="description" content="How moving focus with script affects the CSS focus-visible selector.">
<link rel="alternate" type="text/html" href="https://codepen.io/cssence/pen/ZERBwpz" title="Code example on codepen.io">
</head>
<body>
<main>
<article>
<header>
<h1>:focus-visible and JavaScript</h1>
<p><i>Code</i><br><time data-revised="2022-11-10T07:21:05Z">2022-11-08T13:53:42Z</time><br><img src="/2022/focus-visible-and-javascript/index.png" alt=""></p>
</header>
<div>
<p>Thanks to <a href="https://caniuse.com/css-focus-visible">splendid browser support,</a> utilizing <code>:focus-visible</code> is a thing now. We can finally have highly prominent focus styles for those who navigate our sites with a keyboard, and at the same time do not need to show visitors browsing with a mouse how prominent they are. The keyboard/mouse divide is a bit of a simplification, as there are more input devices out there. In general, web browsers have heuristics to figure out which focus style to apply, but surely <em>how</em> our visitor got to an interactive element will be taken into account.</p>
<p>Which made me wonder, <strong>what if it was not actually the visitor who moved the focus, but the site itself using JavaScript?</strong></p>
<p>First thing I found was the <a href="https://css-tricks.com/almanac/selectors/f/focus-visible/">“focus-visible“ CSS almanac entry on CSS-Tricks,</a> which gave me a clue that <strong>the last thing a visitor does</strong> before Javascript takes over plays a big role here:</p>
<blockquote>
<dl>
<dt><strong>Situation: </strong>A script causes focus to move from a :focus-visible element to another element</dt><dd>→ <strong>Does :focus-visible apply?</strong> Yes</dd>
<dt><strong>Situation: </strong>A script causes focus to move from a non-:focus-visible element to another element</dt><dd>→ <strong>Does :focus-visible apply?</strong> No</dd>
</dl>
</blockquote>
<p>Not being entirely satisfied with this, I created a little test page. Doing so, I’ve been able to confirm the above, and additionally I learned <code>:focus-visible</code> is also applied …</p>
<ul>
<li>when a script moves focus on page load—a scenario where the web browser has a hard time figuring out which input device the visitor used beforehand;</li>
<li>when the target is an editable input field like <code>input[type="text"]</code> or <code>textarea</code>— in these cases the focus-visible style is always applied, input device does not matter.</li>
</ul>
</div>
<aside>
<h2 id="comments">Comments</h2>
<article hidden>
<h3><span data-href="https://mas.to/@CSSence/109313398123556430"><b>Matthias Zöchling</b> wrote on <time>2022-11-09T10:34:43Z</time></span></h3>
<p>Remember the :focus-visible #CSS selector? Have you ever asked yourself what happens when instead of a person a script moves the focus?<br><a href="/2022/focus-visible-and-javascript/">cssence.com/2022/focus-visible</a></p>
</article>
<p>No comments have been added so far.</p>
</aside>
</article>
</main>
</body>
</html>
